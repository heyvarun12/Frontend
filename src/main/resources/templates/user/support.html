<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Support Center â€“ HIMS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="/assets/logo.svg" type="image/svg+xml">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script>
    tailwind.config = {
      theme: { extend: { colors: { primary: "#2563eb" } } }
    }
  </script>
  <style>
    .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 12px; cursor: pointer; transition: background 0.2s; }
    .nav-item:hover { background: #f1f5f9; }
    .card-hover { transition: all 0.25s ease; }
    .card-hover:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.06); }
  </style>
</head>
<body class="bg-slate-50 text-gray-900">

<aside class="fixed top-0 left-0 w-64 h-full bg-white border-r flex flex-col">
  <div class="p-6 border-b flex items-center gap-3">
    <div class="w-10 h-10 rounded-xl bg-primary flex items-center justify-center">
      <i data-lucide="shield" class="text-white"></i>
    </div>
    <div>
      <p class="font-bold text-lg">HIMS</p>
      <p class="text-sm text-gray-500">User Portal</p>
    </div>
  </div>
  <nav class="flex-1 p-4 space-y-1">
    <div class="nav-item" onclick="go('/user/dashboard')"><i data-lucide="layout-dashboard"></i>Dashboard</div>
    <div class="nav-item" onclick="go('/user/policies')"><i data-lucide="file-text"></i>My Policies</div>
    <div class="nav-item" onclick="go('/user/claims')"><i data-lucide="clipboard-list"></i>Claims</div>
    <div class="nav-item" onclick="go('/user/payments')"><i data-lucide="credit-card"></i>Payments</div>
    <div class="nav-item bg-primary/10 text-primary"><i data-lucide="headphones"></i>Support</div>
    <div class="nav-item" onclick="go('/user/profile')"><i data-lucide="user"></i>Profile</div>
  </nav>
  <div class="p-4 border-t">
    <button onclick="go('/logout')" class="w-full flex items-center gap-3 p-3 rounded-xl text-red-600 hover:bg-red-50 font-semibold">
      <i data-lucide="log-out"></i>Logout
    </button>
  </div>
</aside>

<main class="ml-64 p-8">
  <div class="flex items-center justify-between mb-8">
    <div>
      <h1 class="text-3xl font-bold mb-1">Support Center</h1>
      <p class="text-gray-500">Get help and track your support tickets</p>
    </div>
    <button onclick="go('/user/create-ticket')" class="flex items-center gap-2 px-5 py-2 bg-primary text-white rounded-xl font-semibold hover:bg-blue-700 transition">
      <i data-lucide="plus"></i>Create Ticket
    </button>
  </div>

  <div class="grid grid-cols-3 gap-6 mb-8">
    <div class="bg-white rounded-2xl border p-6 flex items-center gap-4">
      <div class="w-12 h-12 rounded-xl bg-sky-100 flex items-center justify-center">
        <i data-lucide="message-square" class="text-sky-600"></i>
      </div>
      <div>
        <p class="text-2xl font-bold" th:text="${#lists.size(tickets.?[ticketStatus == 'OPEN' || ticketStatus == 'RESPONDED'])}">0</p>
        <p class="text-sm text-gray-500">Active Tickets</p>
      </div>
    </div>
    <div class="bg-white rounded-2xl border p-6 flex items-center gap-4">
      <div class="w-12 h-12 rounded-xl bg-amber-100 flex items-center justify-center">
        <i data-lucide="clock" class="text-amber-600"></i>
      </div>
      <div>
        <p class="text-2xl font-bold">24h</p>
        <p class="text-sm text-gray-500">Avg Response</p>
      </div>
    </div>
    <div class="bg-white rounded-2xl border p-6 flex items-center gap-4">
      <div class="w-12 h-12 rounded-xl bg-emerald-100 flex items-center justify-center">
        <i data-lucide="check-circle" class="text-emerald-600"></i>
      </div>
      <div>
        <p class="text-2xl font-bold" th:text="${#lists.size(tickets.?[ticketStatus == 'RESOLVED'])}">0</p>
        <p class="text-sm text-gray-500">Resolved</p>
      </div>
    </div>
  </div>

  <!-- <div class="space-y-4">
    <div th:each="ticket : ${tickets}" class="bg-white rounded-2xl border p-6 card-hover">
      <div class="flex justify-between items-start">
        <div>
          <div class="flex items-center gap-2 mb-2">
            <span class="font-mono text-sm text-gray-500" th:text="'TKT-' + ${ticket.id}">TKT-ID</span>

<a th:href="@{'/support/view/' + ${ticket.id}}" class="px-4 py-2 rounded-lg border font-semibold hover:bg-slate-50">
    View Details
</a>
            <span th:text="${ticket.ticketStatus}" 
                  th:classappend="${ticket.ticketStatus == 'OPEN' ? 'bg-blue-100 text-blue-700' : (ticket.ticketStatus == 'RESOLVED' ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700')}"
                  class="px-3 py-1 text-xs rounded-full font-semibold">Status </span>
          </div>
          <h3 class="text-lg font-semibold mb-2" th:text="${ticket.issueDescription}">Subject</h3>
          <div class="text-xs text-gray-500 mt-3">
            Created: <span th:text="${#temporals.format(ticket.createdDate, 'MMM dd, yyyy')}">Date</span>
          </div>
        </div>
        <a th:href="@{'/support/view/' + ${ticket.ticketId}}" class="px-4 py-2 rounded-lg border font-semibold hover:bg-slate-50">
          View Details
        </a>
      </div>
    </div>
    
    <div th:if="${#lists.isEmpty(tickets)}" class="text-center py-12 bg-white rounded-2xl border border-dashed">
        <p class="text-gray-500">No support tickets found.</p>
    </div>
  </div> -->
<div class="space-y-4">
  <div th:each="ticket : ${tickets}" class="bg-white rounded-2xl border p-6 card-hover">
    <div class="flex justify-between items-start">
      <div>
        <div class="flex items-center gap-2 mb-2">
          <span class="font-mono text-sm text-gray-500" th:text="'TKT-2025-' + ${ticket.id}">TKT-ID</span>
          
          <span th:text="${ticket.ticketStatus}" 
                th:classappend="${ticket.ticketStatus == 'OPEN' ? 'bg-blue-100 text-blue-700' : 'bg-emerald-100 text-emerald-700'}"
                class="px-3 py-1 text-xs rounded-full font-semibold">Status</span>

          <span th:text="${ticket.priority}" 
                th:classappend="${ticket.priority == 'High' ? 'bg-red-100 text-red-700' : 'bg-amber-100 text-amber-700'}"
                class="px-3 py-1 text-xs rounded-full font-semibold">Priority</span>
        </div>
        
        <h3 class="text-xl font-bold mb-1" th:text="${ticket.subject}">Subject Heading</h3>
        
        <p class="text-gray-500 text-sm mb-4" th:text="${ticket.issueDescription}">Description subtext...</p>
        
        <div class="text-xs text-gray-500">
          Created: <span th:text="${#temporals.format(ticket.createdDate, 'MMM dd, yyyy')}">Date</span>
        </div>
      </div>

      <a th:href="@{'/support/view/' + ${ticket.id}}" class="px-6 py-2 rounded-xl border font-semibold hover:bg-slate-50 transition">
        View Details
      </a>
    </div>
  </div>
</div>
  
  <div th:if="${#lists.isEmpty(tickets)}" class="text-center py-12 bg-white rounded-2xl border border-dashed">
      <p class="text-gray-500">No support tickets found.</p>
  </div>
</div>
</main>

<script>
  function go(page) { window.location.href = page; }
  lucide.createIcons();
</script>
</body>
</html>